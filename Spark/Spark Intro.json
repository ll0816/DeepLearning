{"paragraphs":[{"text":"%md ## Intro to Spark Python","dateUpdated":"2017-04-10T05:44:32+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491802665662_-979694626","id":"20170410-053745_1390587169","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Intro to Spark Python</h2>\n"},"dateCreated":"2017-04-10T05:37:45+0000","dateStarted":"2017-04-10T05:44:32+0000","dateFinished":"2017-04-10T05:44:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:298"},{"text":"%md #### System Configuration Check\n\nCheck Spark Version","dateUpdated":"2017-04-10T05:44:32+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491802608764_446676816","id":"20170410-053648_1686808942","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>System Configuration Check</h4>\n<p>Check Spark Version</p>\n"},"dateCreated":"2017-04-10T05:36:48+0000","dateStarted":"2017-04-10T05:44:33+0000","dateFinished":"2017-04-10T05:44:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:299"},{"text":"sc.version","dateUpdated":"2017-04-10T05:44:33+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491802736016_-2049757938","id":"20170410-053856_1235909122","result":{"code":"SUCCESS","type":"TEXT","msg":"res5: String = 1.6.2\n"},"dateCreated":"2017-04-10T05:38:56+0000","dateStarted":"2017-04-10T05:44:33+0000","dateFinished":"2017-04-10T05:44:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:300"},{"text":"%md #### Check Spark Confuguration","dateUpdated":"2017-04-10T05:44:33+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491802845872_1199169567","id":"20170410-054045_360431002","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>Check Spark Confuguration</h4>\n"},"dateCreated":"2017-04-10T05:40:45+0000","dateStarted":"2017-04-10T05:44:34+0000","dateFinished":"2017-04-10T05:44:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:301"},{"text":"sc.getConf.toDebugString.foreach(print)","dateUpdated":"2017-04-10T05:44:33+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491802756981_1527283234","id":"20170410-053916_1518461108","result":{"code":"SUCCESS","type":"TEXT","msg":"args=\nmaster=yarn-client\nspark.app.id=application_1491800026280_0002\nspark.app.name=Zeppelin\nspark.driver.appUIAddress=http://172.17.0.2:4040\nspark.driver.extraClassPath=::/usr/hdp/current/zeppelin-server/interpreter/spark/*::/usr/hdp/current/zeppelin-server/lib/zeppelin-interpreter-0.6.0.2.5.0.0-1245.jar:/usr/hdp/current/zeppelin-server/interpreter/spark/zeppelin-spark-0.6.0.2.5.0.0-1245.jar\nspark.driver.extraJavaOptions=-Dhdp.version=None -Dspark.executor.memory=512m -Dspark.executor.instances=2 -Dspark.yarn.queue=default -Dfile.encoding=UTF-8 -Dlog4j.configuration=file:///usr/hdp/current/zeppelin-server/conf/log4j.properties -Dzeppelin.log.file=/var/log/zeppelin/zeppelin-interpreter-spark-zeppelin-sandbox.hortonworks.com.log\nspark.driver.extraLibraryPath=/usr/hdp/current/hadoop-client/lib/native:/usr/hdp/current/hadoop-client/lib/native/Linux-amd64-64\nspark.driver.host=172.17.0.2\nspark.driver.port=46986\nspark.eventLog.dir=hdfs:///spark-history\nspark.eventLog.enabled=true\nspark.executor.extraLibraryPath=/usr/hdp/current/hadoop-client/lib/native:/usr/hdp/current/hadoop-client/lib/native/Linux-amd64-64\nspark.executor.id=driver\nspark.executor.instances=2\nspark.executor.memory=512m\nspark.executorEnv.PYTHONPATH=/usr/hdp/current/spark-client/python/lib/py4j-0.9-src.zip:/usr/hdp/current/spark-client/python/:/usr/hdp/current/spark-client/python:/usr/hdp/current/spark-client/python/lib/py4j-0.8.2.1-src.zip<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.9-src.zip\nspark.externalBlockStore.folderName=spark-e4c927a7-3dbe-4c58-a719-462cfaa4cffd\nspark.history.fs.logDirectory=hdfs:///spark-history\nspark.history.kerberos.keytab=none\nspark.history.kerberos.principal=none\nspark.history.provider=org.apache.spark.deploy.history.FsHistoryProvider\nspark.history.ui.port=18080\nspark.home=/usr/hdp/2.5.0.0-1245/spark\nspark.jars=file:/usr/hdp/current/zeppelin-server/interpreter/spark/zeppelin-spark-0.6.0.2.5.0.0-1245.jar\nspark.master=yarn-client\nspark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS=sandbox.hortonworks.com\nspark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES=http://sandbox.hortonworks.com:8088/proxy/application_1491800026280_0002\nspark.repl.class.uri=http://172.17.0.2:41767\nspark.scheduler.mode=FAIR\nspark.submit.deployMode=client\nspark.submit.pyArchives=pyspark.zip:py4j-0.9-src.zip:py4j-0.8.2.1-src.zip\nspark.ui.filters=org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter\nspark.yarn.containerLauncherMaxThreads=25\nspark.yarn.dist.files=file:/usr/hdp/2.5.0.0-1245/spark/python/lib/pyspark.zip,file:/usr/hdp/2.5.0.0-1245/spark/python/lib/py4j-0.9-src.zip\nspark.yarn.driver.memoryOverhead=384\nspark.yarn.executor.memoryOverhead=384\nspark.yarn.historyServer.address=sandbox.hortonworks.com:18080\nspark.yarn.isPython=true\nspark.yarn.max.executor.failures=3\nspark.yarn.preserve.staging.files=false\nspark.yarn.queue=default\nspark.yarn.scheduler.heartbeat.interval-ms=5000\nspark.yarn.submit.file.replication=3\nzeppelin.dep.additionalRemoteRepository=spark-packages,http://dl.bintray.com/spark-packages/maven,false;\nzeppelin.dep.localrepo=local-repo\nzeppelin.interpreter.localRepo=/usr/hdp/current/zeppelin-server/local-repo/2C139U1BG\nzeppelin.pyspark.python=python\nzeppelin.spark.concurrentSQL=false\nzeppelin.spark.importImplicit=true\nzeppelin.spark.maxResult=1000\nzeppelin.spark.printREPLOutput=true\nzeppelin.spark.sql.stacktrace=false\nzeppelin.spark.useHiveContext=true"},"dateCreated":"2017-04-10T05:39:16+0000","dateStarted":"2017-04-10T05:44:35+0000","dateFinished":"2017-04-10T05:44:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:302"},{"text":"%md #### Take a Quick Look at Overall Available Resource","dateUpdated":"2017-04-10T05:44:35+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491802920256_511362771","id":"20170410-054200_1503619354","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>Take a Quick Look at Overall Available Resource</h4>\n"},"dateCreated":"2017-04-10T05:42:00+0000","dateStarted":"2017-04-10T05:44:35+0000","dateFinished":"2017-04-10T05:44:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:303"},{"text":"%sh df -hh","dateUpdated":"2017-04-10T05:44:35+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491802944307_-138447472","id":"20170410-054224_51731057","result":{"code":"SUCCESS","type":"TEXT","msg":"Filesystem      Size  Used Avail Use% Mounted on\nrootfs           44G   17G   25G  41% /\noverlay          44G   17G   25G  41% /\ntmpfs           1.9G     0  1.9G   0% /dev\ntmpfs           1.9G     0  1.9G   0% /sys/fs/cgroup\n/dev/sda3        44G   17G   25G  41% /hadoop\n/dev/sda3        44G   17G   25G  41% /etc/resolv.conf\n/dev/sda3        44G   17G   25G  41% /etc/hostname\n/dev/sda3        44G   17G   25G  41% /etc/hosts\nshm              64M     0   64M   0% /dev/shm\n"},"dateCreated":"2017-04-10T05:42:24+0000","dateStarted":"2017-04-10T05:44:36+0000","dateFinished":"2017-04-10T05:44:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:304"},{"text":"%md ### Part I:  Introduction to RDDs with Word Count","dateUpdated":"2017-04-10T05:44:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526787_-1001126717","id":"20170410-023457_179432915","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Part I:  Introduction to RDDs with Word Count</h3>\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:44:37+0000","dateFinished":"2017-04-10T05:44:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:305"},{"text":"%md #### Prepare Directories and Download a Dataset","dateUpdated":"2017-04-10T05:44:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","lineNumbers":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526790_-1002280964","id":"20170410-030342_270573925","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>Prepare Directories and Download a Dataset</h4>\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:44:38+0000","dateFinished":"2017-04-10T05:44:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:306"},{"text":"%sh\ncd/tmp\n\nif [ -e /tmp/About-Apache-NiFi.txt ]\nthen \n   rm -f /tmp/About-Apache-NiFi.txt\nfi\n\nif hadoop fs -stat /tmp/About-Apache-NiFi.txt\nthen \n   hadoop fs -rm /tmp/About-Apache-NiFi.txt\nfi","dateUpdated":"2017-04-10T05:44:38+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526790_-1002280964","id":"20170410-030436_1830956008","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:44:39+0000","dateFinished":"2017-04-10T05:44:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:307"},{"text":"%sh\n\n#Download test file from dropbox folder\nwget https://www.dropbox.com/s/zlx8c3wn85a9ktg/About-Apache-NiFi.txt\n\n# Move dataset to hadoop /tmp\nhadoop fs -put About-Apache-NiFi.txt /tmp","dateUpdated":"2017-04-10T05:44:39+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526791_-1002665713","id":"20170410-030807_1053645022","result":{"code":"INCOMPLETE","type":"TEXT","msg":"--2017-04-10 05:44:47--  https://www.dropbox.com/s/zlx8c3wn85a9ktg/About-Apache-NiFi.txt\nResolving www.dropbox.com... 162.125.4.1\nConnecting to www.dropbox.com|162.125.4.1|:443... connected.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://dl.dropboxusercontent.com/content_link/gWvn3hCMvcwAktVt7Njv5Vagu4dthzzlyuaHfDQrho0KYLxPVqQIgcFP2ANQ6EKg/file [following]\n--2017-04-10 05:44:49--  https://dl.dropboxusercontent.com/content_link/gWvn3hCMvcwAktVt7Njv5Vagu4dthzzlyuaHfDQrho0KYLxPVqQIgcFP2ANQ6EKg/file\nResolving dl.dropboxusercontent.com... 162.125.17.6\nConnecting to dl.dropboxusercontent.com|162.125.17.6|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 15725 (15K) [text/plain]\nSaving to: “About-Apache-NiFi.txt.2”\n\n     0K .......... .....                                      100% 47.4M=0s\n\n2017-04-10 05:44:50 (47.4 MB/s) - “About-Apache-NiFi.txt.2” saved [15725/15725]\n\nParagraph received a SIGTERM.\nExitValue: 143"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:44:40+0000","dateFinished":"2017-04-10T05:45:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:308"},{"text":"%md ### Preview Downloaded Text File","dateUpdated":"2017-04-10T05:44:39+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526791_-1002665713","id":"20170410-031912_610488793","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Preview Downloaded Text File</h3>\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:44:39+0000","dateFinished":"2017-04-10T05:44:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:309"},{"text":"%sh\nhadoop fs -cat /tmp/About-Apache-NiFi.txt | head","dateUpdated":"2017-04-10T05:46:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526792_-1004589458","id":"20170410-031030_318399347","result":{"code":"SUCCESS","type":"TEXT","msg":"Apache NiFi Overview \nTeam dev@nifi.apache.org \n\nWhat is Apache NiFi? Put simply NiFi was built to automate the flow of data between systems. While the term dataflow is used in a variety of contexts, we’ll use it here to mean the automated and managed flow of information between systems. This problem space has been around ever since enterprises had more than one system, where some of the systems created data and some of the systems consumed data. The problems and solution patterns that emerged have been discussed and articulated extensively. A comprehensive and readily consumed form is found in the Enterprise Integration Patterns [eip]. \n\nSome of the high-level challenges of dataflow include: \n\nSystems fail \nNetworks fail, disks fail, software crashes, people make mistakes. \n\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:46:43+0000","dateFinished":"2017-04-10T05:46:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:310"},{"text":"%md ###Read Text File From HDFS and Preview its Contents","dateUpdated":"2017-04-10T05:44:40+0000","config":{"colWidth":10,"editorMode":"ace/mode/markdown","graph":{"mode":"table","height":216,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526792_-1004589458","id":"20170410-031619_429146950","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Read Text File From HDFS and Preview its Contents</h3>\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:44:43+0000","dateFinished":"2017-04-10T05:44:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:311"},{"text":"%pyspark\n\n#Parallelize text file using pre-initialized Spark context\nlines = sc.textFile(\"/tmp/About-Apache-NiFi.txt\")\nprint lines.take(10)","dateUpdated":"2017-04-10T05:44:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526792_-1004589458","id":"20170410-032200_885822060","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'Apache NiFi Overview ', u'Team dev@nifi.apache.org ', u'', u'What is Apache NiFi? Put simply NiFi was built to automate the flow of data between systems. While the term dataflow is used in a variety of contexts, we\\u2019ll use it here to mean the automated and managed flow of information between systems. This problem space has been around ever since enterprises had more than one system, where some of the systems created data and some of the systems consumed data. The problems and solution patterns that emerged have been discussed and articulated extensively. A comprehensive and readily consumed form is found in the Enterprise Integration Patterns [eip]. ', u'', u'Some of the high-level challenges of dataflow include: ', u'', u'Systems fail ', u'Networks fail, disks fail, software crashes, people make mistakes. ', u'']\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:44:43+0000","dateFinished":"2017-04-10T05:45:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:312"},{"text":"%md ###Extract All Words from the Document","dateUpdated":"2017-04-10T05:44:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"lineNumbers":false,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526803_-994970735","id":"20170410-032918_977984473","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Extract All Words from the Document</h3>\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:44:44+0000","dateFinished":"2017-04-10T05:44:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:313"},{"text":"%pyspark\nwords = lines.flatMap(lambda line: line.split(\" \")).cache()","dateUpdated":"2017-04-10T05:44:44+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491800855927_204576168","id":"20170410-050735_1358330240","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-04-10T05:07:35+0000","dateStarted":"2017-04-10T05:44:47+0000","dateFinished":"2017-04-10T05:45:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:314"},{"text":"%md ###Take a look at the first 100 words","dateUpdated":"2017-04-10T05:44:45+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526803_-994970735","id":"20170410-034333_293827267","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Take a look at the first 100 words</h3>\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:44:48+0000","dateFinished":"2017-04-10T05:44:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:315"},{"text":"%pyspark\nprint words.count()","dateUpdated":"2017-04-10T05:44:48+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491800608558_-1274923439","id":"20170410-050328_298058788","result":{"code":"SUCCESS","type":"TEXT","msg":"2627\n"},"dateCreated":"2017-04-10T05:03:28+0000","dateStarted":"2017-04-10T05:45:59+0000","dateFinished":"2017-04-10T05:46:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:316"},{"text":"%md ### Word counts with RDD","dateUpdated":"2017-04-10T05:44:48+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491801032266_-1173550064","id":"20170410-051032_694110277","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Word counts with RDD</h3>\n"},"dateCreated":"2017-04-10T05:10:32+0000","dateStarted":"2017-04-10T05:44:50+0000","dateFinished":"2017-04-10T05:44:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:317"},{"text":"%pyspark\nwordsFiltered = words.filter(lambda w: len(w) > 0)\nwordCounts = wordsFiltered.map(lambda word: (word, 1)).reduceByKey(lambda a, b: a + b).cache()\nprint wordCounts.take(15)","dateUpdated":"2017-04-10T05:44:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526804_-996894480","id":"20170410-034538_2126136824","result":{"code":"SUCCESS","type":"TEXT","msg":"[(u'all', 7), (u'managed', 1), (u'prioritized', 1), (u'partition.', 1), (u'[iot],', 1), (u'Routing,', 1), (u'scale-out', 1), (u'Based', 1), (u'fail-over', 1), (u'depend', 2), (u'chain', 1), (u'Business', 1), (u'send', 1), (u'those', 4), (u'Scheduler', 1)]\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:45:59+0000","dateFinished":"2017-04-10T05:46:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:318"},{"text":"%md ### View Top 20 words in descending order","dateUpdated":"2017-04-10T05:44:48+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491801132995_-512597426","id":"20170410-051212_1162263949","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>View Top 20 words in descending order</h3>\n"},"dateCreated":"2017-04-10T05:12:12+0000","dateStarted":"2017-04-10T05:44:55+0000","dateFinished":"2017-04-10T05:44:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:319"},{"text":"%pyspark\nprint wordCounts.takeOrdered(20, lambda (w, c): -c)\n","dateUpdated":"2017-04-10T05:44:49+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526804_-996894480","id":"20170410-034535_1685144783","result":{"code":"SUCCESS","type":"TEXT","msg":"[(u'the', 110), (u'of', 94), (u'and', 89), (u'to', 84), (u'is', 62), (u'a', 60), (u'NiFi', 41), (u'as', 32), (u'The', 28), (u'be', 26), (u'in', 25), (u'are', 22), (u'it', 22), (u'data', 20), (u'that', 20), (u'for', 19), (u'can', 19), (u'or', 19), (u'on', 17), (u'system', 16)]\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:46:00+0000","dateFinished":"2017-04-10T05:46:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:320"},{"text":"%md ## Part II:  Introduction to DataFrames and SparkSQL \n\n#### View Top 20 words in descending order","dateUpdated":"2017-04-10T05:44:49+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526805_-997279228","id":"20170410-034531_1315660191","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Part II:  Introduction to DataFrames and SparkSQL</h2>\n<h4>View Top 20 words in descending order</h4>\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:44:55+0000","dateFinished":"2017-04-10T05:44:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:321"},{"text":"%pyspark\n\n# First, transform RDD to a DataFrame\nwordCountsDF = wordCounts.map(lambda (w, c): Row(word=w, count=c)).toDF()\nwordCountsDF.printSchema()","dateUpdated":"2017-04-10T05:44:50+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526805_-997279228","id":"20170410-034517_1911745376","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- count: long (nullable = true)\n |-- word: string (nullable = true)\n\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:46:03+0000","dateFinished":"2017-04-10T05:46:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:322"},{"text":"%md #### View Top 20 words in descending order","dateUpdated":"2017-04-10T05:44:50+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491801230382_-1698287912","id":"20170410-051350_1713575298","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>View Top 20 words in descending order</h4>\n"},"dateCreated":"2017-04-10T05:13:50+0000","dateStarted":"2017-04-10T05:44:56+0000","dateFinished":"2017-04-10T05:44:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:323"},{"text":"%pyspark\nwordCountsDF.show(10)","dateUpdated":"2017-04-10T05:44:50+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526805_-997279228","id":"20170410-034504_713988265","result":{"code":"SUCCESS","type":"TEXT","msg":"+-----+-----------+\n|count|       word|\n+-----+-----------+\n|    7|        all|\n|    1|    managed|\n|    1|prioritized|\n|    1| partition.|\n|    1|     [iot],|\n|    1|   Routing,|\n|    1|  scale-out|\n|    1|      Based|\n|    1|  fail-over|\n|    2|     depend|\n+-----+-----------+\nonly showing top 10 rows\n\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:46:03+0000","dateFinished":"2017-04-10T05:46:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:324"},{"text":"%md #### View Top 20 words in descending order","dateUpdated":"2017-04-10T05:44:55+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491801287374_1132602550","id":"20170410-051447_270481899","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>View Top 20 words in descending order</h4>\n"},"dateCreated":"2017-04-10T05:14:47+0000","dateStarted":"2017-04-10T05:44:57+0000","dateFinished":"2017-04-10T05:44:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:325"},{"text":"%pyspark\nsqlc.registerDataFrameAsTable(wordCountsDF, \"word_counts\")","dateUpdated":"2017-04-10T05:44:55+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526806_-996124982","id":"20170410-034457_398285606","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:46:05+0000","dateFinished":"2017-04-10T05:46:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:326"},{"text":"%md #### View Top 20 words in descending order","dateUpdated":"2017-04-10T05:44:56+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491801306783_-451778096","id":"20170410-051506_1379108133","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>View Top 20 words in descending order</h4>\n"},"dateCreated":"2017-04-10T05:15:06+0000","dateStarted":"2017-04-10T05:44:57+0000","dateFinished":"2017-04-10T05:44:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:327"},{"text":"%sql\n-- Display word counts in descending order\nSELECT word, count FROM word_counts ORDER BY count DESC limit 20","dateUpdated":"2017-04-10T05:44:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526806_-996124982","id":"20170410-040008_850667006","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\nthe\t110\nof\t94\nand\t89\nto\t84\nis\t62\na\t60\nNiFi\t41\nas\t32\nThe\t28\nbe\t26\nin\t25\nit\t22\nare\t22\nthat\t20\ndata\t20\nor\t19\nfor\t19\ncan\t19\non\t17\nsystem\t16\n","comment":"","msgTable":[[{"key":"count","value":"the"},{"key":"count","value":"110"}],[{"value":"of"},{"value":"94"}],[{"value":"and"},{"value":"89"}],[{"value":"to"},{"value":"84"}],[{"value":"is"},{"value":"62"}],[{"value":"a"},{"value":"60"}],[{"value":"NiFi"},{"value":"41"}],[{"value":"as"},{"value":"32"}],[{"value":"The"},{"value":"28"}],[{"value":"be"},{"value":"26"}],[{"value":"in"},{"value":"25"}],[{"value":"it"},{"value":"22"}],[{"value":"are"},{"value":"22"}],[{"value":"that"},{"value":"20"}],[{"value":"data"},{"value":"20"}],[{"value":"or"},{"value":"19"}],[{"value":"for"},{"value":"19"}],[{"value":"can"},{"value":"19"}],[{"value":"on"},{"value":"17"}],[{"value":"system"},{"value":"16"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["the","110"],["of","94"],["and","89"],["to","84"],["is","62"],["a","60"],["NiFi","41"],["as","32"],["The","28"],["be","26"],["in","25"],["it","22"],["are","22"],["that","20"],["data","20"],["or","19"],["for","19"],["can","19"],["on","17"],["system","16"]]},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:46:08+0000","dateFinished":"2017-04-10T05:46:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:328"},{"text":"%md #### View Top 20 words in descending order","dateUpdated":"2017-04-10T05:44:57+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491801398562_-851593500","id":"20170410-051638_1774319894","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>View Top 20 words in descending order</h4>\n"},"dateCreated":"2017-04-10T05:16:38+0000","dateStarted":"2017-04-10T05:44:58+0000","dateFinished":"2017-04-10T05:44:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:329"},{"text":"%pyspark\n# Convert wordsFiltered RDD to a DataFrame\nwordsDF = wordsFiltered.map(lambda w: Row(word=w, count=1)).toDF()\nprint wordsDF.show(10)","dateUpdated":"2017-04-10T05:44:58+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526806_-996124982","id":"20170410-040154_1243727794","result":{"code":"SUCCESS","type":"TEXT","msg":"+-----+-------------------+\n|count|               word|\n+-----+-------------------+\n|    1|             Apache|\n|    1|               NiFi|\n|    1|           Overview|\n|    1|               Team|\n|    1|dev@nifi.apache.org|\n|    1|               What|\n|    1|                 is|\n|    1|             Apache|\n|    1|              NiFi?|\n|    1|                Put|\n+-----+-------------------+\nonly showing top 10 rows\n\nNone\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:46:09+0000","dateFinished":"2017-04-10T05:46:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:330"},{"text":"%md #### View Top 20 words in descending order","dateUpdated":"2017-04-10T05:44:58+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491801451336_350270119","id":"20170410-051731_1787505981","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>View Top 20 words in descending order</h4>\n"},"dateCreated":"2017-04-10T05:17:31+0000","dateStarted":"2017-04-10T05:44:59+0000","dateFinished":"2017-04-10T05:44:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:331"},{"text":"%pyspark\n\n(wordsDF.groupBy(\"word\")\n        .sum()\n        .orderBy(\"sum(count)\", ascending=0)\n        .limit(10).show())","dateUpdated":"2017-04-10T05:44:58+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526806_-996124982","id":"20170410-040159_1088380095","result":{"code":"SUCCESS","type":"TEXT","msg":"+----+----------+\n|word|sum(count)|\n+----+----------+\n| the|       110|\n|  of|        94|\n| and|        89|\n|  to|        84|\n|  is|        62|\n|   a|        60|\n|NiFi|        41|\n|  as|        32|\n| The|        28|\n|  be|        26|\n+----+----------+\n\n"},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:46:09+0000","dateFinished":"2017-04-10T05:46:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:332"},{"dateUpdated":"2017-04-10T05:44:59+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491799526806_-996124982","id":"20170410-040158_1015120059","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-04-10T04:45:26+0000","dateStarted":"2017-04-10T05:46:11+0000","dateFinished":"2017-04-10T05:46:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:333"}],"name":"Spark Intro","id":"2CDA529NA","angularObjects":{"2BYG9GAN3:shared_process":[],"2C139U1BG:shared_process":[],"2BYWWZJPK:shared_process":[],"2C2VAKPN2:shared_process":[],"2BZC2RPUW:shared_process":[],"2BZQEH9EH:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}